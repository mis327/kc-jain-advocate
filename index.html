<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>KC Jain - Supreme Court Advocate | Legacy of Justice</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Cormorant+Garamond:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    
    <style>
        /* [Your existing CSS remains exactly the same - no changes] */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0a1a2f;
            --primary-light: #1e3a5f;
            --primary-dark: #051020;
            --secondary: #c9a959;
            --secondary-light: #d4b778;
            --secondary-dark: #b38f3f;
            --accent: #4a90e2;
            --text-dark: #1e293b;
            --text-light: #64748b;
            --background: #f9fbfd;
            --white: #ffffff;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.02), 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0,0,0,0.25);
            --gradient-primary: linear-gradient(135deg, #0a1a2f 0%, #1e3a5f 100%);
            --gradient-gold: linear-gradient(135deg, #c9a959 0%, #d4b778 50%, #b38f3f 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            --border-radius-2xl: 32px;
            --border-radius-full: 9999px;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--background);
            min-height: 100vh;
            overflow-x: hidden;
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        #scrollProgress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: var(--gradient-gold);
            z-index: 1001;
            transition: width 0.3s ease;
            box-shadow: 0 0 20px rgba(201, 169, 89, 0.5);
        }

        #loadingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 26, 47, 0.98);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1002;
            flex-direction: column;
            transition: opacity 0.5s ease;
        }

        .spinner {
            width: 70px;
            height: 70px;
            border: 4px solid rgba(201, 169, 89, 0.1);
            border-top: 4px solid var(--secondary);
            border-radius: 50%;
            animation: spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            margin-bottom: 25px;
            box-shadow: 0 0 30px rgba(201, 169, 89, 0.3);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        header {
            background: rgba(10, 26, 47, 0.95);
            backdrop-filter: blur(10px);
            color: var(--white);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(201, 169, 89, 0.2);
        }

        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.2rem;
            color: var(--secondary);
            background: rgba(201, 169, 89, 0.1);
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-md);
            transition: all 0.3s ease;
        }

        .logo:hover .logo-icon {
            transform: rotate(10deg);
            background: rgba(201, 169, 89, 0.2);
        }

        .logo h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            background: linear-gradient(135deg, var(--white) 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-tagline {
            font-size: 0.8rem;
            opacity: 0.8;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        nav {
            display: flex;
            gap: 10px;
        }

        nav a {
            color: var(--white);
            text-decoration: none;
            padding: 10px 20px;
            border-radius: var(--border-radius-full);
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95rem;
            position: relative;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        nav a:hover {
            background: rgba(201, 169, 89, 0.1);
            color: var(--secondary);
            transform: translateY(-2px);
        }

        nav a.active {
            background: var(--gradient-gold);
            color: var(--primary);
            font-weight: 600;
        }

        #mobileMenuBtn {
            display: none;
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255,255,255,0.1);
            transition: all 0.3s ease;
        }

        #mobileMenuBtn:hover {
            background: var(--secondary);
            color: var(--primary);
        }

        .hero-section {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 80px 0;
            position: relative;
            overflow: hidden;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, rgba(201,169,89,0.15) 0%, transparent 70%);
            border-radius: 50%;
            animation: pulse 8s ease-in-out infinite;
        }

        .hero-section::after {
            content: '⚖️';
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-size: 120px;
            opacity: 0.05;
            transform: rotate(15deg);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.15; }
            50% { transform: scale(1.1); opacity: 0.2; }
        }

        .hero-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: flex;
            align-items: center;
            gap: 60px;
            position: relative;
            z-index: 1;
        }

        .profile-image-wrapper {
            flex: 0 0 300px;
            position: relative;
        }

        .profile-image-wrapper img {
            width: 300px;
            height: 300px;
            border-radius: var(--border-radius-2xl);
            object-fit: cover;
            border: 4px solid var(--secondary);
            box-shadow: var(--shadow-2xl);
            transition: transform 0.5s ease;
        }

        .profile-image-wrapper img:hover {
            transform: scale(1.02) rotate(1deg);
        }

        .profile-content-right {
            flex: 1;
        }

        .profile-motto {
            font-family: 'Playfair Display', serif;
            font-size: 3.8rem;
            font-weight: 800;
            color: var(--secondary);
            line-height: 1.2;
            margin-bottom: 20px;
        }

        .profile-motto span {
            display: inline-block;
            background: rgba(255,255,255,0.1);
            padding: 5px 15px;
            border-radius: var(--border-radius-full);
            backdrop-filter: blur(5px);
            margin-right: 10px;
            font-size: 1.8rem;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .profile-content-right p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 30px;
            line-height: 1.8;
            max-width: 800px;
        }

        #admin-photo-btn {
            background: rgba(255,255,255,0.15);
            color: var(--white);
            border: 2px solid var(--secondary);
            padding: 12px 25px;
            border-radius: var(--border-radius-full);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: none;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
        }

        #admin-photo-btn.visible {
            display: inline-flex;
        }

        #admin-photo-btn:hover {
            background: var(--secondary);
            color: var(--primary);
            transform: translateX(-50%) translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        main {
            max-width: 1400px;
            margin: 60px auto;
            padding: 0 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 60px;
        }

        .stat-card {
            background: var(--white);
            padding: 35px 25px;
            border-radius: var(--border-radius-xl);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
            border: 1px solid rgba(201, 169, 89, 0.1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-gold);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .stat-card:hover::before {
            transform: scaleX(1);
        }

        .stat-icon {
            font-size: 2.5rem;
            color: var(--secondary);
            margin-bottom: 20px;
            background: rgba(201, 169, 89, 0.1);
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            margin: 0 auto 20px;
            transition: all 0.3s ease;
        }

        .stat-card:hover .stat-icon {
            transform: scale(1.1);
            background: rgba(201, 169, 89, 0.2);
        }

        .stat-number {
            font-size: 2.8rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
            font-family: 'Playfair Display', serif;
            line-height: 1;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 500;
        }

        .content-section {
            margin-bottom: 60px;
            background: var(--white);
            border-radius: var(--border-radius-2xl);
            padding: 45px;
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(201, 169, 89, 0.1);
            transition: all 0.3s ease;
        }

        .content-section:hover {
            box-shadow: var(--shadow-lg);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 35px;
            padding-bottom: 20px;
            border-bottom: 2px dashed rgba(201, 169, 89, 0.3);
            flex-wrap: wrap;
            gap: 20px;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 15px;
            font-weight: 700;
        }

        .section-title i {
            color: var(--secondary);
            font-size: 2rem;
        }

        .search-box {
            padding: 14px 25px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius-full);
            width: 320px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(201, 169, 89, 0.1);
            width: 380px;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 20px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: var(--border-radius-full);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .filter-btn.active {
            background: var(--gradient-gold);
            color: var(--primary);
            border-color: var(--secondary);
        }

        .filter-btn:hover {
            background: var(--secondary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
        }

        .content-card {
            background: var(--white);
            border-radius: var(--border-radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            transition: all 0.4s ease;
            border: 1px solid rgba(201, 169, 89, 0.1);
            display: flex;
            flex-direction: column;
            height: 100%;
            position: relative;
        }

        .content-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-2xl);
            border-color: var(--secondary);
        }

        .card-media {
            height: 220px;
            overflow: hidden;
            position: relative;
        }

        .card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
            cursor: pointer;
        }

        .content-card:hover .card-image {
            transform: scale(1.1);
        }

        .video-play-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(201, 169, 89, 0.9);
            color: var(--primary);
            border: none;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-lg);
        }

        .video-play-btn:hover {
            background: var(--secondary);
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: var(--shadow-2xl);
        }

        .card-header {
            padding: 25px 25px 15px;
            position: relative;
        }

        .card-category {
            display: inline-block;
            padding: 6px 15px;
            background: var(--gradient-gold);
            color: var(--primary);
            border-radius: var(--border-radius-full);
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .card-date {
            color: var(--text-light);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }

        .card-body {
            padding: 0 25px 20px;
            flex-grow: 1;
        }

        .card-title {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 12px;
            line-height: 1.4;
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }

        .card-text {
            color: var(--text-light);
            line-height: 1.7;
            font-size: 0.95rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .read-more-btn {
            background: none;
            border: none;
            color: var(--secondary);
            cursor: pointer;
            font-weight: 600;
            padding: 8px 0;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .read-more-btn:hover {
            gap: 12px;
            color: var(--primary);
        }

        .card-footer {
            padding: 20px 25px;
            border-top: 1px solid rgba(201, 169, 89, 0.1);
            display: flex;
            gap: 12px;
            background: #f8fafc;
        }

        .admin-btn {
            padding: 10px 15px;
            border: none;
            border-radius: var(--border-radius-full);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            flex: 1;
            justify-content: center;
        }

        .admin-btn i {
            font-size: 1rem;
        }

        .edit-btn {
            background: #f59e0b;
            color: var(--primary);
        }

        .edit-btn:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .share-btn {
            background: #3b82f6;
            color: var(--white);
        }

        .share-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .delete-btn {
            background: #ef4444;
            color: var(--white);
        }

        .delete-btn:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .image-preview-item {
            position: relative;
            border-radius: var(--border-radius-md);
            overflow: hidden;
            aspect-ratio: 1;
            border: 2px solid var(--secondary);
            box-shadow: var(--shadow-md);
        }

        .image-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .video-preview-item {
            position: relative;
            border-radius: var(--border-radius-md);
            overflow: hidden;
            aspect-ratio: 16/9;
            border: 2px solid var(--secondary);
            box-shadow: var(--shadow-md);
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-preview-item i {
            font-size: 3rem;
            color: var(--secondary);
            opacity: 0.8;
        }

        .video-preview-item .video-filename {
            position: absolute;
            bottom: 5px;
            left: 5px;
            font-size: 0.7rem;
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 2px 5px;
            border-radius: 3px;
            max-width: 90%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger);
            color: var(--white);
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            border: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .remove-image:hover {
            background: #b91c1c;
            transform: scale(1.1);
        }

        .admin-panel {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            padding: 40px;
            border-radius: var(--border-radius-xl);
            margin-bottom: 30px;
            border: 1px solid rgba(201, 169, 89, 0.2);
            box-shadow: var(--shadow-lg);
            display: none;
        }

        .admin-panel.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .formatting-toolbar {
            background: var(--white);
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius-full);
            padding: 10px 20px;
            margin: 10px 0 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
            box-shadow: var(--shadow-sm);
        }

        .formatting-toolbar button {
            padding: 8px 15px;
            border: none;
            border-radius: var(--border-radius-full);
            background: #f8fafc;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: var(--primary);
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .formatting-toolbar button:hover {
            background: var(--secondary);
            color: var(--primary);
            transform: translateY(-2px);
        }

        .formatting-toolbar select,
        .formatting-toolbar input {
            padding: 8px 15px;
            border: 1px solid #e2e8f0;
            border-radius: var(--border-radius-full);
            background: var(--white);
            cursor: pointer;
        }

        .qr-preview {
            background: linear-gradient(135deg, #0a1a2f 0%, #1e3a5f 100%);
            color: var(--white);
            border-radius: var(--border-radius-2xl);
            padding: 45px;
            margin-top: 40px;
            box-shadow: var(--shadow-2xl);
            display: none;
        }

        .qr-preview.visible {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .qr-display {
            display: grid;
            grid-template-columns: 220px 1fr;
            gap: 40px;
            margin-bottom: 25px;
        }

        #qr-code-img {
            width: 220px;
            height: 220px;
            border-radius: var(--border-radius-lg);
            border: 4px solid var(--secondary);
            background: var(--white);
            transition: all 0.3s ease;
            object-fit: contain;
        }

        #qr-code-img:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-2xl);
        }

        .qr-data-row {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 1.1rem;
        }

        .qr-data-row strong {
            color: var(--secondary);
            width: 120px;
            display: inline-block;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--white);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 4px rgba(201, 169, 89, 0.1);
        }

        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }

        .file-upload {
            padding: 35px;
            border: 3px dashed #cbd5e1;
            border-radius: var(--border-radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8fafc;
        }

        .file-upload:hover {
            border-color: var(--secondary);
            background: rgba(201, 169, 89, 0.05);
            transform: translateY(-2px);
        }

        .file-upload i {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 15px;
        }

        .file-upload p {
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--primary);
        }

        .file-upload small {
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .btn-group {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 35px;
            border: none;
            border-radius: var(--border-radius-full);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: var(--white);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--gradient-gold);
            color: var(--primary);
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-warning {
            background: #f59e0b;
            color: var(--primary);
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ef4444;
            color: var(--white);
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-info {
            background: #3b82f6;
            color: var(--white);
        }

        .btn-info:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: var(--white);
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .table-responsive {
            overflow-x: auto;
            border-radius: var(--border-radius-lg);
            background: var(--white);
            box-shadow: var(--shadow-lg);
        }

        .qr-table {
            width: 100%;
            border-collapse: collapse;
        }

        .qr-table th {
            background: var(--primary);
            color: var(--white);
            padding: 18px;
            font-weight: 600;
            text-align: left;
            font-size: 0.95rem;
        }

        .qr-table td {
            padding: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .qr-table tr:hover {
            background: rgba(201, 169, 89, 0.05);
        }

        .qr-small {
            width: 60px;
            height: 60px;
            border-radius: var(--border-radius-md);
            border: 2px solid var(--secondary);
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .qr-small:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .empty-state {
            text-align: center;
            padding: 70px 20px;
            color: var(--text-light);
        }

        .empty-state i {
            font-size: 5rem;
            color: var(--secondary);
            opacity: 0.3;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }

        #toastContainer {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 1003;
        }

        .toast {
            background: var(--white);
            padding: 18px 25px;
            border-radius: var(--border-radius-full);
            box-shadow: var(--shadow-2xl);
            margin-bottom: 15px;
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.4s ease;
            border-left: 4px solid var(--secondary);
            min-width: 380px;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1rem;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast.success { border-left-color: #10b981; }
        .toast.error { border-left-color: #ef4444; }
        .toast.warning { border-left-color: #f59e0b; }
        .toast.info { border-left-color: #3b82f6; }

        .toast i {
            font-size: 1.5rem;
        }

        .toast.success i { color: #10b981; }
        .toast.error i { color: #ef4444; }
        .toast.warning i { color: #f59e0b; }
        .toast.info i { color: #3b82f6; }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 2001;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
        }

        .close-modal {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 40px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: rgba(255,255,255,0.1);
            transform: rotate(90deg);
        }

        #modal-image {
            max-width: 100%;
            max-height: 90vh;
            border-radius: var(--border-radius-lg);
        }

        #modal-video {
            max-width: 100%;
            max-height: 80vh;
            border-radius: var(--border-radius-lg);
        }

        #content-modal .modal-content {
            background: var(--white);
            max-width: 1000px;
            width: 90%;
            max-height: 90vh;
            border-radius: var(--border-radius-2xl);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .modal-header {
            background: var(--primary);
            color: white;
            padding: 20px 35px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--secondary);
        }

        .modal-header h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .modal-header h3 i {
            color: var(--secondary);
        }

        .modal-header .close-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            font-size: 28px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-header .close-btn:hover {
            background: var(--secondary);
            color: var(--primary);
            transform: rotate(90deg);
        }

        #content-modal-body {
            padding: 40px;
            overflow-y: auto;
            flex-grow: 1;
        }

        .modal-footer {
            padding: 20px 35px;
            border-top: 2px solid rgba(201, 169, 89, 0.2);
            background: #f8fafc;
            text-align: right;
        }

        .modal-footer .btn {
            width: auto;
            padding: 12px 35px;
        }

        footer {
            background: var(--primary);
            color: var(--white);
            padding: 80px 0 30px;
            margin-top: 100px;
            position: relative;
            overflow: hidden;
        }

        footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-gold);
        }

        .footer-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 60px;
            position: relative;
            z-index: 1;
        }

        .footer-section h3 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            margin-bottom: 25px;
            color: var(--secondary);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 15px;
        }

        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-links a:hover {
            color: var(--secondary);
            transform: translateX(8px);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .social-links a {
            color: var(--white);
            background: rgba(201, 169, 89, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .social-links a:hover {
            background: var(--secondary);
            color: var(--primary);
            transform: translateY(-5px) scale(1.1);
        }

        .copyright {
            text-align: center;
            padding: 40px 20px 0;
            color: #94a3b8;
            font-size: 0.95rem;
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 60px;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
        }

        .contact-item {
            text-align: center;
            padding: 45px 35px;
            background: #f8fafc;
            border-radius: var(--border-radius-xl);
            transition: all 0.3s ease;
        }

        .contact-item:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            background: var(--white);
        }

        .contact-item i {
            font-size: 3.5rem;
            color: var(--secondary);
            margin-bottom: 20px;
        }

        .contact-item h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .contact-item p {
            color: var(--text-light);
            line-height: 1.8;
            font-size: 1.1rem;
        }

        #qr-system-section, #admin {
            display: none;
        }

        #qr-system-section.visible, #admin.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Login Modal */
        #loginModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-card {
            background: var(--white);
            max-width: 500px;
            width: 90%;
            padding: 50px;
            border-radius: var(--border-radius-2xl);
            box-shadow: var(--shadow-2xl);
            border: 2px solid var(--secondary);
            position: relative;
            animation: modalPop 0.3s ease;
        }

        @keyframes modalPop {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-card h2 {
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            margin-bottom: 30px;
            text-align: center;
            font-size: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .modal-card h2 i {
            color: var(--secondary);
        }

        @media (max-width: 1024px) {
            .hero-content {
                flex-direction: column;
                text-align: center;
                gap: 30px;
            }
            
            .profile-motto {
                font-size: 3.2rem;
            }
            
            .profile-motto span {
                font-size: 1.5rem;
            }
            
            .profile-content-right p {
                margin-left: auto;
                margin-right: auto;
            }
            
            .qr-display {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            #qr-code-img {
                margin: 0 auto;
            }
            
            .section-title {
                font-size: 2.2rem;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
            }
            
            nav {
                display: none;
                width: 100%;
                flex-direction: column;
                gap: 5px;
                margin-top: 15px;
            }
            
            nav.active {
                display: flex;
            }
            
            #mobileMenuBtn {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .hero-content {
                padding: 0 20px;
            }
            
            .profile-motto {
                font-size: 2.5rem;
            }
            
            .profile-motto span {
                font-size: 1.2rem;
                display: inline-block;
                margin: 5px;
            }
            
            .profile-image-wrapper img {
                width: 250px;
                height: 250px;
            }
            
            .section-header {
                flex-direction: column;
                gap: 20px;
                align-items: stretch;
            }
            
            .search-box {
                width: 100%;
            }
            
            .search-box:focus {
                width: 100%;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .filter-buttons {
                justify-content: center;
            }
            
            .card-footer {
                flex-wrap: wrap;
            }
            
            .admin-btn {
                flex: 1 1 auto;
            }
            
            #content-modal .modal-content {
                width: 95%;
                max-height: 95vh;
            }
            
            .modal-header {
                padding: 15px 20px;
            }
            
            .modal-header h3 {
                font-size: 1.4rem;
            }
            
            #content-modal-body {
                padding: 25px;
            }
            
            .modal-footer {
                padding: 15px 20px;
            }
            
            .content-section {
                padding: 30px 20px;
            }
            
            .footer-container {
                gap: 40px;
            }
        }

        @media (max-width: 480px) {
            .profile-motto {
                font-size: 2rem;
            }
            
            .profile-motto span {
                font-size: 1rem;
            }
            
            .stat-number {
                font-size: 2.2rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .modal-card {
                padding: 35px 25px;
            }
            
            .toast {
                min-width: auto;
                width: calc(100vw - 60px);
                font-size: 0.9rem;
            }
            
            .formatting-toolbar {
                border-radius: var(--border-radius-lg);
                padding: 15px;
            }
            
            .formatting-toolbar button {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .qr-display {
                gap: 20px;
            }
            
            #qr-code-img {
                width: 180px;
                height: 180px;
            }
            
            .qr-preview {
                padding: 30px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Scroll Progress -->
    <div id="scrollProgress"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay">
        <div class="spinner"></div>
        <p style="color: var(--secondary); font-size: 1.2rem; letter-spacing: 1px;">KC Jain & Associates</p>
        <p style="color: var(--white); font-size: 0.9rem; opacity: 0.8;">Legacy of Justice • Excellence • Integrity</p>
    </div>

    <!-- Login Modal - NO PRE-FILLED CREDENTIALS -->
    <div id="loginModal" style="display: none;">
        <div class="modal-card">
            <h2><i class="fas fa-gavel"></i> Admin Access</h2>
            
            <div class="form-group">
                <label><i class="fas fa-envelope"></i> Email</label>
                <input type="email" id="admin-email" class="form-control" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label><i class="fas fa-lock"></i> Password</label>
                <input type="password" id="admin-password" class="form-control" placeholder="Enter admin password">
            </div>
            <button id="login-btn" class="btn btn-primary">
                <i class="fas fa-sign-in-alt"></i> Login to Admin Panel
            </button>
            <button id="cancel-login" class="btn btn-secondary" style="margin-top: 10px;">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-scale-balanced"></i>
                </div>
                <div>
                    <h1>KC Jain</h1>
                    <div class="logo-tagline">ADVOCATE · SUPREME COURT</div>
                </div>
            </div>
            
            <button id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <nav id="navMenu">
                <a href="#home" class="active"><i class="fas fa-home"></i> Home</a>
                <a href="#cases"><i class="fas fa-gavel"></i> Cases</a>
                <a href="#posts"><i class="fas fa-newspaper"></i> Posts</a>
                <a href="#blogs"><i class="fas fa-blog"></i> Blogs</a>
                <a href="#announcements"><i class="fas fa-bullhorn"></i> Announcements</a>
                <a href="#admin" id="openAdminMenu"><i class="fas fa-cog"></i> Admin</a>
                <a href="#qr-system-section" id="openQRFormMenu"><i class="fas fa-qrcode"></i> Tree QR</a>
                <a href="#contact"><i class="fas fa-envelope"></i> Contact</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section" id="home">
        <div class="hero-content">
            <div class="profile-image-wrapper">
                <img id="profile-image" src="/uploads/profile/default-profile.jpg" alt="KC Jain - Supreme Court Advocate">
                <button id="admin-photo-btn">
                    <i class="fas fa-camera"></i> Update Photo
                </button>
                <input type="file" id="profile-upload" accept="image/*" style="display: none;">
            </div>
            <div class="profile-content-right">
                <div class="profile-motto">
                    <span>JUSTICE</span> <span>INTEGRITY</span> <span>EXCELLENCE</span>
                </div>
                <p>With over three decades of distinguished practice in the Supreme Court of India, KC Jain has established himself as a formidable force in constitutional law, public interest litigation, and environmental jurisprudence. His unwavering commitment to justice has shaped landmark decisions and set precedents that continue to guide the legal fraternity.</p>
                <a href="#contact" class="btn btn-primary" style="display: inline-flex; width: auto; padding: 15px 40px;">
                    <i class="fas fa-calendar-check"></i> Schedule Consultation
                </a>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main>
        <!-- Stats Section -->
        <section class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-gavel"></i></div>
                <div class="stat-number" id="cases-count">0</div>
                <div class="stat-label">Landmark Cases</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-newspaper"></i></div>
                <div class="stat-number" id="posts-count">0</div>
                <div class="stat-label">Legal Posts</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-blog"></i></div>
                <div class="stat-number" id="blogs-count">0</div>
                <div class="stat-label">Blog Articles</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-bullhorn"></i></div>
                <div class="stat-number" id="announcements-count">0</div>
                <div class="stat-label">Announcements</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-qrcode"></i></div>
                <div class="stat-number" id="qr-count">0</div>
                <div class="stat-label">Tree QR Codes</div>
            </div>
        </section>

        <!-- Admin Panel Section -->
        <section class="content-section" id="admin">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-cog"></i> Admin Panel</h2>
                <div>
                    <button id="close-admin" class="btn btn-warning">
                        <i class="fas fa-times"></i> Close
                    </button>
                    <button id="refresh-content" class="btn btn-primary">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
            </div>

            <div class="admin-panel visible" id="adminPanel">
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Content Type *</label>
                        <select id="content-type" class="form-control">
                            <option value="case">Case Study</option>
                            <option value="post">Legal Post</option>
                            <option value="blog">Blog Article</option>
                            <option value="announcement">Announcement</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-folder"></i> Category *</label>
                        <input type="text" id="content-category" class="form-control" placeholder="e.g., PIL, Environment, RTI">
                    </div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-heading"></i> Title *</label>
                    <input type="text" id="content-title" class="form-control" placeholder="Enter title...">
                </div>

                <div class="formatting-toolbar">
                    <button onclick="document.execCommand('bold', false, null); app.showToast('Bold applied', 'success');"><i class="fas fa-bold"></i></button>
                    <button onclick="document.execCommand('italic', false, null); app.showToast('Italic applied', 'success');"><i class="fas fa-italic"></i></button>
                    <button onclick="document.execCommand('underline', false, null); app.showToast('Underline applied', 'success');"><i class="fas fa-underline"></i></button>
                    <select onchange="document.execCommand('fontName', false, this.value); app.showToast('Font changed', 'success');">
                        <option value="">Font</option>
                        <option value="Inter">Inter</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Times New Roman">Times</option>
                        <option value="Arial">Arial</option>
                    </select>
                    <select onchange="document.execCommand('fontSize', false, this.value); app.showToast('Size changed', 'success');">
                        <option value="">Size</option>
                        <option value="3">Small</option>
                        <option value="4">Normal</option>
                        <option value="5">Large</option>
                        <option value="6">X-Large</option>
                    </select>
                    <input type="color" onchange="document.execCommand('foreColor', false, this.value); app.showToast('Color applied', 'success');" value="#000000" title="Text Color">
                    <input type="color" onchange="document.execCommand('hiliteColor', false, this.value); app.showToast('Background applied', 'success');" value="#ffff00" title="Background Color">
                    <button onclick="document.execCommand('justifyLeft', false, null); app.showToast('Left align', 'success');"><i class="fas fa-align-left"></i></button>
                    <button onclick="document.execCommand('justifyCenter', false, null); app.showToast('Center align', 'success');"><i class="fas fa-align-center"></i></button>
                    <button onclick="document.execCommand('justifyRight', false, null); app.showToast('Right align', 'success');"><i class="fas fa-align-right"></i></button>
                    <button onclick="document.execCommand('insertUnorderedList', false, null); app.showToast('Bullet list', 'success');"><i class="fas fa-list-ul"></i></button>
                    <button onclick="document.execCommand('insertOrderedList', false, null); app.showToast('Numbered list', 'success');"><i class="fas fa-list-ol"></i></button>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-file-alt"></i> Content *</label>
                    <div contenteditable="true" id="content-editor" class="form-control" style="min-height: 200px; overflow-y: auto;" placeholder="Enter content..."></div>
                    <textarea id="content-text" style="display: none;"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-images"></i> Multiple Images</label>
                        <div class="file-upload" onclick="document.getElementById('content-images-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload images</p>
                            <small>Max 5MB each (JPG, PNG, GIF)</small>
                            <input type="file" id="content-images-upload" accept="image/*" multiple style="display: none;">
                        </div>
                        <div id="images-preview" class="images-grid"></div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-video"></i> Video</label>
                        <div class="file-upload" onclick="document.getElementById('content-video-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload video</p>
                            <small>Max 100MB (MP4, MOV)</small>
                            <input type="file" id="content-video-upload" accept="video/*" style="display: none;">
                        </div>
                        <div id="video-preview" class="images-grid"></div>
                    </div>
                </div>

                <div class="btn-group">
                    <button id="submit-content" class="btn btn-success">
                        <i class="fas fa-save"></i> Save Content
                    </button>
                    <button id="clear-form" class="btn btn-primary">
                        <i class="fas fa-broom"></i> Clear Form
                    </button>
                </div>
            </div>
        </section>

        <!-- Cases Section -->
        <section class="content-section" id="cases">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-gavel"></i> Landmark Cases</h2>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="pil">PIL</button>
                    <button class="filter-btn" data-filter="environment">Environment</button>
                    <button class="filter-btn" data-filter="constitutional">Constitutional</button>
                    <button class="filter-btn" data-filter="rti">RTI</button>
                </div>
                <input type="text" id="cases-search" class="search-box" placeholder="Search cases...">
            </div>
            <div id="cases-container" class="content-grid"></div>
        </section>

        <!-- Posts Section -->
        <section class="content-section" id="posts">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-newspaper"></i> Legal Posts</h2>
                <input type="text" id="posts-search" class="search-box" placeholder="Search posts...">
            </div>
            <div id="posts-container" class="content-grid"></div>
        </section>

        <!-- Blogs Section -->
        <section class="content-section" id="blogs">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-blog"></i> Blog Articles</h2>
                <input type="text" id="blogs-search" class="search-box" placeholder="Search blogs...">
            </div>
            <div id="blogs-container" class="content-grid"></div>
        </section>

        <!-- Announcements Section -->
        <section class="content-section" id="announcements">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-bullhorn"></i> Announcements</h2>
                <input type="text" id="announcements-search" class="search-box" placeholder="Search announcements...">
            </div>
            <div id="announcements-container" class="content-grid"></div>
        </section>

        <!-- QR System Section -->
        <section class="content-section" id="qr-system-section">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-qrcode"></i> Tree QR System</h2>
                <div>
                    <button id="close-qr" class="btn btn-warning">
                        <i class="fas fa-times"></i> Close QR
                    </button>
                </div>
            </div>

            <form id="qr-form">
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-tree"></i> Tree ID *</label>
                        <input type="text" id="tree-id" class="form-control" placeholder="e.g., TREE-001" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-leaf"></i> Tree Name *</label>
                        <input type="text" id="tree-name" class="form-control" placeholder="e.g., Mango Tree" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-calendar-alt"></i> Planted Date *</label>
                        <input type="date" id="planted-date" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-map-marker-alt"></i> Location *</label>
                        <input type="text" id="location" class="form-control" placeholder="e.g., Central Park, Delhi" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-user"></i> Planted By *</label>
                        <input type="text" id="planted-by" class="form-control" placeholder="e.g., KC Jain Foundation" required>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-seedling"></i> Scientific Name</label>
                        <input type="text" id="scientific-name" class="form-control" placeholder="e.g., Mangifera indica">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-images"></i> Tree Images</label>
                        <div class="file-upload" onclick="document.getElementById('tree-images-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Upload Multiple Images</p>
                            <small>Max 5MB each</small>
                            <input type="file" id="tree-images-upload" accept="image/*" multiple style="display: none;">
                        </div>
                        <div id="tree-images-preview" class="images-grid"></div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-video"></i> Tree Video</label>
                        <div class="file-upload" onclick="document.getElementById('tree-video-upload').click()">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Upload Video</p>
                            <small>Max 100MB</small>
                            <input type="file" id="tree-video-upload" accept="video/*" style="display: none;">
                        </div>
                        <div id="tree-video-preview" class="images-grid"></div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-heartbeat"></i> Health Status</label>
                        <select id="tree-health" class="form-control">
                            <option value="Excellent">Excellent</option>
                            <option value="Good" selected>Good</option>
                            <option value="Fair">Fair</option>
                            <option value="Poor">Poor</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-ruler-vertical"></i> Height (feet)</label>
                        <input type="number" id="tree-height" class="form-control" placeholder="e.g., 15">
                    </div>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-file-alt"></i> Description</label>
                    <textarea id="tree-description" class="form-control" placeholder="Enter tree description..." rows="4"></textarea>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-qrcode"></i> Generate QR
                    </button>
                    <button type="button" id="clear-qr-form" class="btn btn-primary">
                        <i class="fas fa-broom"></i> Clear
                    </button>
                </div>
            </form>

            <div id="qr-preview-section" class="qr-preview">
                <div class="section-header" style="border-bottom-color: rgba(255,255,255,0.2);">
                    <h2 class="section-title" style="color: var(--white);"><i class="fas fa-check-circle" style="color: var(--secondary);"></i> QR Generated</h2>
                </div>
                
                <div class="qr-display">
                    <img id="qr-code-img" src="" alt="QR Code">
                    <div>
                        <div id="qr-data-display"></div>
                        <div id="qr-media-preview" style="margin-top: 20px;"></div>
                    </div>
                </div>

                <div class="btn-group" style="margin-top: 30px;">
                    <button id="print-qr" class="btn btn-primary">
                        <i class="fas fa-print"></i> Print
                    </button>
                    <button id="save-qr" class="btn btn-success">
                        <i class="fas fa-download"></i> Save
                    </button>
                    <button id="generate-another" class="btn btn-warning">
                        <i class="fas fa-plus"></i> New
                    </button>
                </div>
            </div>

            <div style="margin-top: 40px;">
                <div class="section-header">
                    <h2 class="section-title"><i class="fas fa-history"></i> QR History</h2>
                    <input type="text" id="qr-search" class="search-box" placeholder="Search QR codes...">
                </div>
                <div id="qr-history-container"></div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="content-section" id="contact">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-envelope"></i> Contact & Chambers</h2>
            </div>
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Agra Office</h3>
                    <p><br>E-103 & 104 Shanta Tower<br>Sanjay Place, Agra 282007</p>
                    <br><h3>Supreme Court Chambers</h3>
                    <p><br> 48 Lawyers Chamber</p>
                    <p>New Delhi - 110001</p>
                </div>
                <div class="contact-item">
                    <i class="fas fa-phone"></i>
                    <h3>Contact</h3>
                    <p>+91 94122 63072</p>
                </div>
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <h3>Email</h3>
                    <p>kcjain@gmail.com</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3>KC Jain & Associates</h3>
                <p>Distinguished Supreme Court practice with a legacy of landmark judgments and unwavering commitment to constitutional values since 1990.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Practice Areas</h3>
                <ul class="footer-links">
                    <li><a href="#"><i class="fas fa-gavel"></i> Constitutional Law</a></li>
                    <li><a href="#"><i class="fas fa-leaf"></i> Environmental Law</a></li>
                    <li><a href="#"><i class="fas fa-users"></i> Public Interest Litigation</a></li>
                    <li><a href="#"><i class="fas fa-file-contract"></i> Civil Litigation</a></li>
                    <li><a href="#"><i class="fas fa-info-circle"></i> RTI Matters</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#home"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#cases"><i class="fas fa-gavel"></i> Landmark Cases</a></li>
                    <li><a href="#blogs"><i class="fas fa-blog"></i> Legal Insights</a></li>
                    <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Chambers</h3>
                <p><i class="fas fa-clock"></i> Mon - Sat: 10:00 AM - 7:00 PM</p>
                <p><i class="fas fa-clock"></i> Sunday: By Appointment</p>
                <p><i class="fas fa-certificate"></i> Supreme Court of India</p>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2026 KC Jain & Associates. All rights reserved. | Designed for justice, built with excellence.</p>
        </div>
    </footer>

    <!-- Modals -->
    <div id="image-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="document.getElementById('image-modal').style.display='none'">×</button>
            <img id="modal-image" src="" alt="Full Size Image">
        </div>
    </div>

    <div id="video-modal" class="modal">
        <div class="modal-content">
            <button class="close-modal" onclick="document.getElementById('video-modal').style.display='none'">×</button>
            <video id="modal-video" controls>
                <source src="" type="video/mp4">
            </video>
        </div>
    </div>

    <div id="content-modal" class="modal" onclick="if(event.target === this) document.getElementById('content-modal').style.display='none'">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-gavel"></i> KC Jain & Associates</h3>
                <button class="close-btn" onclick="app.closeContentModal()">×</button>
            </div>
            <div id="content-modal-body"></div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="app.closeContentModal()">
                    <i class="fas fa-times"></i> Close
                </button>
            </div>
        </div>
    </div>

    <script>
        // Complete Enhanced App with all features matching the backend
        let app = {
            content: [],
            qrData: [],
            isAdminLoggedIn: false,
            editingContentId: null,
            profileImagePath: '',
            sessionToken: null,
            apiBaseUrl: window.location.origin,

            async init() {
                this.setupScrollProgress();
                this.setupEventListeners();
                this.setupFileUploadPreviews();
                this.hideLoading();
                this.checkSharedContent();
                
                // Load all data from server
                await this.loadContentFromServer();
                await this.loadQRFromServer();
                await this.loadProfileImage();
                await this.loadStats();
                
                // Set default date for QR form
                const today = new Date().toISOString().split('T')[0];
                if (document.getElementById('planted-date')) {
                    document.getElementById('planted-date').value = today;
                }
                
                // Check if user was previously logged in (session storage)
                this.checkSavedSession();
            },

            setupScrollProgress() {
                window.addEventListener('scroll', () => {
                    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                    const scrolled = height > 0 ? (winScroll / height) * 100 : 0;
                    document.getElementById('scrollProgress').style.width = scrolled + '%';
                });
            },

            hideLoading() {
                setTimeout(() => {
                    document.getElementById('loadingOverlay').style.display = 'none';
                }, 1200);
            },

            showToast(message, type = 'info') {
                const container = document.getElementById('toastContainer');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                container.appendChild(toast);
                setTimeout(() => toast.classList.add('show'), 10);
                
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }, 3500);
            },

            checkSavedSession() {
                const savedToken = sessionStorage.getItem('adminToken');
                const savedEmail = sessionStorage.getItem('adminEmail');
                if (savedToken && savedEmail) {
                    this.verifyToken(savedToken);
                }
            },

            async verifyToken(token) {
                try {
                    const response = await fetch('/api/auth/verify', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ token })
                    });
                    
                    const result = await response.json();
                    
                    if (result.valid) {
                        this.isAdminLoggedIn = true;
                        this.sessionToken = token;
                        document.getElementById('admin-photo-btn').classList.add('visible');
                        this.showToast(`Welcome back, ${result.name}!`, 'success');
                    }
                } catch (error) {
                    console.error('Token verification failed:', error);
                    sessionStorage.removeItem('adminToken');
                    sessionStorage.removeItem('adminEmail');
                }
            },

            setupEventListeners() {
                // Mobile menu
                document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                    document.getElementById('navMenu').classList.toggle('active');
                });

                document.addEventListener('click', (e) => {
                    if (!e.target.closest('nav') && !e.target.closest('#mobileMenuBtn')) {
                        document.getElementById('navMenu').classList.remove('active');
                    }
                });

                // Admin login
                document.getElementById('openAdminMenu').addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (!this.isAdminLoggedIn) {
                        document.getElementById('loginModal').style.display = 'flex';
                    } else {
                        this.showAdminSection();
                    }
                    
                    document.getElementById('navMenu').classList.remove('active');
                });

                document.getElementById('openQRFormMenu').addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (!this.isAdminLoggedIn) {
                        document.getElementById('loginModal').style.display = 'flex';
                    } else {
                        this.showQRSection();
                    }
                    
                    document.getElementById('navMenu').classList.remove('active');
                });

                document.getElementById('login-btn').addEventListener('click', async () => {
                    const email = document.getElementById('admin-email').value.trim();
                    const password = document.getElementById('admin-password').value;
                    
                    if (!email || !password) {
                        this.showToast('Please enter email and password', 'warning');
                        return;
                    }
                    
                    try {
                        const response = await fetch('/api/auth/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ email, password })
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            this.isAdminLoggedIn = true;
                            this.sessionToken = result.token;
                            
                            // Save session
                            sessionStorage.setItem('adminToken', result.token);
                            sessionStorage.setItem('adminEmail', result.email);
                            
                            document.getElementById('loginModal').style.display = 'none';
                            document.getElementById('admin-photo-btn').classList.add('visible');
                            this.showToast(`Welcome back, ${result.name}!`, 'success');
                            
                            // Load content from server
                            await this.loadContentFromServer();
                            await this.loadQRFromServer();
                            
                            this.showAdminSection();
                        } else {
                            this.showToast('Invalid email or password', 'error');
                        }
                    } catch (error) {
                        console.error('Login error:', error);
                        this.showToast('Login failed. Check server connection.', 'error');
                    }
                });

                document.getElementById('cancel-login').addEventListener('click', () => {
                    document.getElementById('loginModal').style.display = 'none';
                });

                window.addEventListener('click', (e) => {
                    if (e.target.id === 'loginModal') {
                        document.getElementById('loginModal').style.display = 'none';
                    }
                });

                document.getElementById('admin-photo-btn').addEventListener('click', () => {
                    if (this.isAdminLoggedIn) {
                        document.getElementById('profile-upload').click();
                    } else {
                        this.showToast('Admin login required', 'warning');
                        document.getElementById('loginModal').style.display = 'flex';
                    }
                });

                document.getElementById('profile-upload').addEventListener('change', (e) => {
                    if (this.isAdminLoggedIn) {
                        this.handleProfileImageUpload(e);
                    }
                });

                document.getElementById('close-admin').addEventListener('click', () => {
                    document.getElementById('admin').classList.remove('visible');
                });

                document.getElementById('close-qr').addEventListener('click', () => {
                    document.getElementById('qr-system-section').classList.remove('visible');
                });

                document.getElementById('refresh-content').addEventListener('click', async () => {
                    await this.loadContentFromServer();
                    await this.loadQRFromServer();
                    await this.loadStats();
                    this.showToast('Content refreshed from server', 'success');
                });

                document.getElementById('submit-content').addEventListener('click', () => {
                    if (!this.isAdminLoggedIn) {
                        this.showToast('Admin login required', 'warning');
                        document.getElementById('loginModal').style.display = 'flex';
                        return;
                    }
                    this.saveContent();
                });

                document.getElementById('clear-form').addEventListener('click', () => {
                    document.getElementById('content-title').value = '';
                    document.getElementById('content-editor').innerHTML = '';
                    document.getElementById('content-category').value = '';
                    document.getElementById('images-preview').innerHTML = '';
                    document.getElementById('video-preview').innerHTML = '';
                    this.editingContentId = null;
                    document.getElementById('submit-content').innerHTML = '<i class="fas fa-save"></i> Save Content';
                    document.getElementById('submit-content').classList.remove('btn-warning');
                    this.showToast('Form cleared', 'info');
                });

                document.getElementById('qr-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (!this.isAdminLoggedIn) {
                        this.showToast('Admin login required', 'warning');
                        document.getElementById('loginModal').style.display = 'flex';
                        return;
                    }
                    this.generateQRCode();
                });

                document.getElementById('clear-qr-form').addEventListener('click', () => {
                    document.getElementById('qr-form').reset();
                    document.getElementById('tree-images-preview').innerHTML = '';
                    document.getElementById('tree-video-preview').innerHTML = '';
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('planted-date').value = today;
                    this.showToast('QR form cleared', 'info');
                });

                document.getElementById('print-qr').addEventListener('click', () => this.printQR());
                document.getElementById('save-qr').addEventListener('click', () => this.saveQR());
                document.getElementById('generate-another').addEventListener('click', () => {
                    document.getElementById('qr-preview-section').classList.remove('visible');
                    document.getElementById('qr-form').reset();
                    document.getElementById('tree-images-preview').innerHTML = '';
                    document.getElementById('tree-video-preview').innerHTML = '';
                    const today = new Date().toISOString().split('T')[0];
                    document.getElementById('planted-date').value = today;
                });

                // Search functionality
                ['cases', 'posts', 'blogs', 'announcements', 'qr'].forEach(type => {
                    const input = document.getElementById(type + '-search');
                    if (input) {
                        input.addEventListener('input', (e) => this.searchContent(type, e.target.value));
                    }
                });

                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.filterCases(e.target.dataset.filter);
                    });
                });

                document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
                    anchor.addEventListener('click', (e) => {
                        if (anchor.getAttribute('href') === '#') return;
                        e.preventDefault();
                        
                        const targetId = anchor.getAttribute('href');
                        if (targetId === '#home') {
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        } else {
                            const target = document.querySelector(targetId);
                            if (target) {
                                target.scrollIntoView({ behavior: 'smooth' });
                            }
                        }
                        
                        document.getElementById('navMenu').classList.remove('active');
                    });
                });

                document.querySelectorAll('.close-modal').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.getElementById('image-modal').style.display = 'none';
                        document.getElementById('video-modal').style.display = 'none';
                        document.getElementById('content-modal').style.display = 'none';
                        
                        const video = document.getElementById('modal-video');
                        if (video) {
                            video.pause();
                            video.src = '';
                        }
                    });
                });

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeContentModal();
                        
                        document.getElementById('video-modal').style.display = 'none';
                        const video = document.getElementById('modal-video');
                        if (video) {
                            video.pause();
                            video.src = '';
                        }
                    }
                });
            },

            closeContentModal() {
                document.getElementById('content-modal').style.display = 'none';
            },

            showAdminSection() {
                document.getElementById('admin').classList.add('visible');
                document.getElementById('admin').scrollIntoView({ behavior: 'smooth' });
            },

            showQRSection() {
                document.getElementById('qr-system-section').classList.add('visible');
                document.getElementById('qr-system-section').scrollIntoView({ behavior: 'smooth' });
            },

            async loadContentFromServer() {
                try {
                    const response = await fetch('/api/content');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    if (data.content) {
                        this.content = data.content.map(item => ({
                            id: item.id,
                            type: item.type,
                            title: item.title,
                            text: item.text,
                            category: item.category || 'General',
                            date: item.created_date,
                            displayDate: this.formatDate(item.created_date),
                            media: item.media || []
                        }));
                        
                        this.displayAllContent();
                        this.updateStats();
                    }
                } catch (error) {
                    console.error('Error loading content:', error);
                    this.showToast('Failed to load content from server', 'error');
                }
            },

            async loadQRFromServer() {
                try {
                    const response = await fetch('/api/qr');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    if (data.qrData) {
                        this.qrData = data.qrData.map(item => ({
                            id: item.id,
                            treeId: item.tree_id,
                            treeName: item.tree_name,
                            location: item.location,
                            plantedDate: item.planted_date,
                            displayDate: this.formatDate(item.planted_date),
                            qrCodeUrl: item.qr_code_url,
                            media: item.treeImages || [],
                            videoData: item.tree_video_url,
                            healthStatus: item.health_status,
                            treeHeight: item.tree_height,
                            description: item.description,
                            scientificName: item.scientific_name,
                            plantedBy: item.planted_by
                        }));
                        
                        this.displayQRHistory();
                        this.updateStats();
                    }
                } catch (error) {
                    console.error('Error loading QR data:', error);
                }
            },

            async loadProfileImage() {
                try {
                    const response = await fetch('/api/profile');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    if (data.profileImage) {
                        document.getElementById('profile-image').src = data.profileImage;
                        this.profileImagePath = data.profileImage;
                    }
                } catch (error) {
                    console.error('Error loading profile image:', error);
                    // Fallback to default
                    document.getElementById('profile-image').src = '/uploads/profile/default-profile.jpg';
                }
            },

            async loadStats() {
                try {
                    const response = await fetch('/api/stats');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    document.getElementById('cases-count').textContent = data.cases || 0;
                    document.getElementById('posts-count').textContent = data.posts || 0;
                    document.getElementById('blogs-count').textContent = data.blogs || 0;
                    document.getElementById('announcements-count').textContent = data.announcements || 0;
                    document.getElementById('qr-count').textContent = data.qr || 0;
                } catch (error) {
                    console.error('Error loading stats:', error);
                }
            },

            setupFileUploadPreviews() {
                // Images preview for content
                document.getElementById('content-images-upload').addEventListener('change', (e) => {
                    const files = Array.from(e.target.files);
                    const previewContainer = document.getElementById('images-preview');
                    previewContainer.innerHTML = '';
                    
                    files.forEach((file) => {
                        if (file.type.startsWith('image/')) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                const previewDiv = document.createElement('div');
                                previewDiv.className = 'image-preview-item';
                                previewDiv.innerHTML = `
                                    <img src="${e.target.result}">
                                    <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                                `;
                                previewContainer.appendChild(previewDiv);
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    if (files.length > 0) {
                        this.showToast(`${files.length} image(s) selected`, 'info');
                    }
                });

                document.getElementById('content-video-upload').addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    const previewContainer = document.getElementById('video-preview');
                    previewContainer.innerHTML = '';
                    
                    if (file) {
                        const previewDiv = document.createElement('div');
                        previewDiv.className = 'video-preview-item';
                        
                        const reader = new FileReader();
                        reader.onload = (fileData) => {
                            previewDiv.setAttribute('data-video-data', fileData.target.result);
                            previewDiv.setAttribute('data-video-name', file.name);
                            previewDiv.setAttribute('data-video-type', file.type);
                        };
                        reader.readAsDataURL(file);
                        
                        previewDiv.innerHTML = `
                            <i class="fas fa-video"></i>
                            <span class="video-filename">${file.name.substring(0, 20)}${file.name.length > 20 ? '...' : ''}</span>
                            <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                        `;
                        
                        previewContainer.appendChild(previewDiv);
                        this.showToast(`Video selected: ${file.name}`, 'info');
                    }
                });

                // Images preview for tree
                document.getElementById('tree-images-upload').addEventListener('change', (e) => {
                    const files = Array.from(e.target.files);
                    const previewContainer = document.getElementById('tree-images-preview');
                    previewContainer.innerHTML = '';
                    
                    files.forEach((file) => {
                        if (file.type.startsWith('image/')) {
                            const reader = new FileReader();
                            reader.onload = (e) => {
                                const previewDiv = document.createElement('div');
                                previewDiv.className = 'image-preview-item';
                                previewDiv.innerHTML = `
                                    <img src="${e.target.result}">
                                    <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                                `;
                                previewContainer.appendChild(previewDiv);
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    if (files.length > 0) {
                        this.showToast(`${files.length} tree image(s) selected`, 'info');
                    }
                });

                document.getElementById('tree-video-upload').addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    const previewContainer = document.getElementById('tree-video-preview');
                    previewContainer.innerHTML = '';
                    
                    if (file) {
                        const previewDiv = document.createElement('div');
                        previewDiv.className = 'video-preview-item';
                        
                        const reader = new FileReader();
                        reader.onload = (fileData) => {
                            previewDiv.setAttribute('data-video-data', fileData.target.result);
                            previewDiv.setAttribute('data-video-name', file.name);
                            previewDiv.setAttribute('data-video-type', file.type);
                        };
                        reader.readAsDataURL(file);
                        
                        previewDiv.innerHTML = `
                            <i class="fas fa-video"></i>
                            <span class="video-filename">${file.name.substring(0, 20)}${file.name.length > 20 ? '...' : ''}</span>
                            <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                        `;
                        
                        previewContainer.appendChild(previewDiv);
                        this.showToast(`Tree video selected: ${file.name}`, 'info');
                    }
                });
            },

            async handleProfileImageUpload(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        this.showToast('Image size should be less than 5MB', 'error');
                        return;
                    }
                    
                    this.showToast('Uploading profile image...', 'info');
                    
                    const reader = new FileReader();
                    reader.onload = async (e) => {
                        const imageData = e.target.result;
                        
                        // Show preview immediately (optimistic update)
                        document.getElementById('profile-image').src = imageData;
                        
                        try {
                            // Upload to server
                            const response = await fetch('/api/profile/upload', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'Authorization': `Bearer ${this.sessionToken || ''}`
                                },
                                body: JSON.stringify({
                                    imageData: imageData
                                })
                            });
                            
                            const result = await response.json();
                            
                            if (result.success) {
                                this.showToast('Profile photo updated successfully!', 'success');
                                // Update with server URL
                                document.getElementById('profile-image').src = result.profileImage;
                                this.profileImagePath = result.profileImage;
                            } else {
                                this.showToast('Failed to upload: ' + (result.error || 'Unknown error'), 'error');
                                // Revert preview
                                await this.loadProfileImage();
                            }
                        } catch (error) {
                            console.error('Upload error:', error);
                            this.showToast('Failed to upload profile image', 'error');
                            // Revert preview
                            await this.loadProfileImage();
                        }
                    };
                    reader.readAsDataURL(file);
                }
            },

            async saveContent() {
                const type = document.getElementById('content-type').value;
                const title = document.getElementById('content-title').value.trim();
                const editorContent = document.getElementById('content-editor').innerHTML.trim();
                const category = document.getElementById('content-category').value.trim() || 'General';

                if (!title || !editorContent || editorContent === '<br>') {
                    this.showToast('Please fill in title and content', 'error');
                    return;
                }

                this.showToast('Saving content...', 'info');

                const files = [];
                
                // Collect images
                const imagePreviews = document.querySelectorAll('#images-preview .image-preview-item img');
                for (const img of imagePreviews) {
                    if (img.src.startsWith('data:')) {
                        files.push({
                            name: `image_${Date.now()}.jpg`,
                            type: 'image',
                            data: img.src
                        });
                    }
                }

                // Collect video
                const videoPreview = document.querySelector('#video-preview .video-preview-item');
                if (videoPreview) {
                    const videoData = videoPreview.getAttribute('data-video-data');
                    const videoName = videoPreview.getAttribute('data-video-name') || 'video.mp4';
                    
                    if (videoData) {
                        files.push({
                            name: videoName,
                            type: 'video',
                            data: videoData
                        });
                    }
                }

                const contentData = {
                    id: this.editingContentId,
                    type: type,
                    title: title,
                    text: editorContent,
                    category: category,
                    author: 'KC Jain',
                    featured: 0,
                    language: 'en'
                };

                try {
                    const url = this.editingContentId ? `/api/content/${this.editingContentId}` : '/api/content';
                    const method = this.editingContentId ? 'PUT' : 'POST';
                    
                    const response = await fetch(url, {
                        method: method,
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.sessionToken || ''}`
                        },
                        body: JSON.stringify({
                            data: contentData,
                            files: files
                        })
                    });

                    const result = await response.json();

                    if (result.success) {
                        this.showToast(this.editingContentId ? 'Content updated successfully!' : 'Content saved successfully!', 'success');
                        
                        await this.loadContentFromServer();
                        await this.loadStats();
                        
                        this.clearContentForm();
                        
                        if (!this.editingContentId) {
                            document.getElementById('qr-system-section').classList.remove('visible');
                        }
                    } else {
                        this.showToast('Error saving: ' + (result.error || 'Unknown error'), 'error');
                    }
                } catch (error) {
                    console.error('Save error:', error);
                    this.showToast('Failed to save content', 'error');
                }
            },

            displayAllContent() {
                const containers = {
                    'cases': 'case',
                    'posts': 'post',
                    'blogs': 'blog',
                    'announcements': 'announcement'
                };

                Object.entries(containers).forEach(([containerId, type]) => {
                    const container = document.getElementById(containerId + '-container');
                    if (container) {
                        container.innerHTML = '';
                        const items = this.content.filter(item => item.type === type);
                        
                        if (items.length === 0) {
                            container.innerHTML = `
                                <div class="empty-state">
                                    <i class="fas fa-${type === 'case' ? 'gavel' : type === 'post' ? 'newspaper' : type === 'blog' ? 'blog' : 'bullhorn'}"></i>
                                    <h3>No ${type}s Available</h3>
                                    <p>Add your first ${type} using the admin panel.</p>
                                </div>
                            `;
                            return;
                        }

                        items.sort((a, b) => new Date(b.date) - new Date(a.date));
                        
                        items.forEach(item => {
                            container.appendChild(this.createContentCard(item));
                        });
                    }
                });
            },

            createContentCard(item) {
                const card = document.createElement('div');
                card.className = 'content-card';
                card.dataset.id = item.id;
                card.dataset.category = (item.category || '').toLowerCase();

                let mediaHTML = '';
                if (item.media && item.media.length > 0) {
                    const firstMedia = item.media[0];
                    if (firstMedia.type === 'image') {
                        mediaHTML = `
                            <div class="card-media">
                                <img src="${firstMedia.url}" class="card-image" onclick="app.openImageModal('${firstMedia.url}')">
                            </div>
                        `;
                    } else if (firstMedia.type === 'video') {
                        const videoUrl = firstMedia.url;
                        
                        mediaHTML = `
                            <div class="card-media">
                                <button class="video-play-btn" onclick="app.openVideoModal('${videoUrl}', '${item.id}')">
                                    <i class="fas fa-play"></i>
                                </button>
                            </div>
                        `;
                    }
                }

                card.innerHTML = `
                    ${mediaHTML}
                    <div class="card-header">
                        <span class="card-category">${item.category || item.type}</span>
                        <div class="card-date"><i class="far fa-calendar"></i> ${item.displayDate}</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">${this.escapeHTML(item.title)}</h3>
                        <div class="card-text">${this.stripHTML(item.text).substring(0, 150)}...</div>
                        <button class="read-more-btn" onclick="app.showFullContent('${item.id}')">
                            Read More <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    <div class="card-footer">
                        ${this.isAdminLoggedIn ? `
                            <button class="admin-btn edit-btn" onclick="app.editContent('${item.id}')">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        ` : ''}
                        <button class="admin-btn share-btn" onclick="app.copyShareLink('${item.id}')">
                            <i class="fas fa-share-alt"></i> Share
                        </button>
                        ${this.isAdminLoggedIn ? `
                            <button class="admin-btn delete-btn" onclick="app.deleteContent('${item.id}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        ` : ''}
                    </div>
                `;

                return card;
            },

            stripHTML(html) {
                const div = document.createElement('div');
                div.innerHTML = html;
                return div.textContent || div.innerText || '';
            },

            getShareableLink(contentId) {
                return `${window.location.origin}${window.location.pathname}?content=${contentId}`;
            },

            copyShareLink(contentId) {
                const link = this.getShareableLink(contentId);
                navigator.clipboard.writeText(link).then(() => {
                    this.showToast('Link copied to clipboard!', 'success');
                }).catch(() => {
                    this.showToast('Failed to copy link', 'error');
                });
            },

            checkSharedContent() {
                const params = new URLSearchParams(window.location.search);
                const contentId = params.get('content');
                if (contentId) {
                    setTimeout(() => {
                        this.showFullContent(contentId);
                    }, 1500);
                }
            },

            showFullContent(contentId) {
                const item = this.content.find(c => c.id === contentId);
                if (item) {
                    const modal = document.getElementById('content-modal');
                    const modalBody = document.getElementById('content-modal-body');
                    
                    let mediaHTML = '';
                    if (item.media) {
                        item.media.forEach(media => {
                            if (media.type === 'image') {
                                mediaHTML += `<img src="${media.url}" style="max-width: 100%; margin: 20px 0; border-radius: var(--border-radius-lg); cursor: pointer; box-shadow: var(--shadow-lg);" onclick="app.openImageModal('${media.url}')">`;
                            } else if (media.type === 'video') {
                                const videoUrl = media.url;
                                if (videoUrl && videoUrl !== '#') {
                                    mediaHTML += `
                                        <video controls style="max-width: 100%; margin: 20px 0; border-radius: var(--border-radius-lg); box-shadow: var(--shadow-lg);">
                                            <source src="${videoUrl}" type="video/mp4">
                                        </video>
                                    `;
                                }
                            }
                        });
                    }

                    modalBody.innerHTML = `
                        <h2 style="color: var(--primary); margin-bottom: 20px; font-family: 'Playfair Display', serif; font-size: 2.2rem;">${this.escapeHTML(item.title)}</h2>
                        <div style="color: var(--text-light); margin-bottom: 30px; display: flex; gap: 20px; align-items: center; flex-wrap: wrap; padding-bottom: 20px; border-bottom: 2px dashed rgba(201, 169, 89, 0.3);">
                            <span class="card-category" style="font-size: 0.9rem;">${item.category || item.type}</span>
                            <span><i class="far fa-calendar-alt"></i> ${item.displayDate}</span>
                        </div>
                        ${mediaHTML}
                        <div style="line-height: 1.9; color: var(--text-dark); font-size: 1.1rem; margin-top: 20px;">${item.text}</div>
                    `;
                    
                    modal.style.display = 'flex';
                }
            },

            editContent(contentId) {
                if (!this.isAdminLoggedIn) {
                    this.showToast('Admin login required', 'warning');
                    document.getElementById('loginModal').style.display = 'flex';
                    return;
                }

                const item = this.content.find(c => c.id === contentId);
                if (item) {
                    document.getElementById('content-type').value = item.type;
                    document.getElementById('content-title').value = item.title;
                    document.getElementById('content-editor').innerHTML = item.text;
                    document.getElementById('content-category').value = item.category || '';
                    
                    document.getElementById('images-preview').innerHTML = '';
                    document.getElementById('video-preview').innerHTML = '';
                    
                    if (item.media) {
                        item.media.forEach(media => {
                            if (media.type === 'image') {
                                const previewDiv = document.createElement('div');
                                previewDiv.className = 'image-preview-item';
                                previewDiv.innerHTML = `
                                    <img src="${media.url}">
                                    <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                                `;
                                document.getElementById('images-preview').appendChild(previewDiv);
                            } else if (media.type === 'video') {
                                const previewDiv = document.createElement('div');
                                previewDiv.className = 'video-preview-item';
                                
                                previewDiv.innerHTML = `
                                    <i class="fas fa-video"></i>
                                    <span class="video-filename">Video Preview</span>
                                    <button class="remove-image" onclick="this.parentElement.remove()">×</button>
                                `;
                                document.getElementById('video-preview').appendChild(previewDiv);
                            }
                        });
                    }
                    
                    this.editingContentId = contentId;
                    document.getElementById('submit-content').innerHTML = '<i class="fas fa-save"></i> Update Content';
                    document.getElementById('submit-content').classList.add('btn-warning');
                    
                    this.showAdminSection();
                    this.showToast('Edit mode activated', 'info');
                }
            },

            async deleteContent(contentId) {
                if (!this.isAdminLoggedIn) {
                    this.showToast('Admin login required', 'warning');
                    return;
                }

                if (confirm('Are you sure you want to delete this item?')) {
                    try {
                        const response = await fetch(`/api/content/${contentId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${this.sessionToken || ''}`
                            }
                        });

                        const result = await response.json();

                        if (result.success) {
                            await this.loadContentFromServer();
                            await this.loadStats();
                            this.showToast('Content deleted successfully', 'success');
                        } else {
                            this.showToast('Error deleting content', 'error');
                        }
                    } catch (error) {
                        console.error('Delete error:', error);
                        this.showToast('Failed to delete content', 'error');
                    }
                }
            },

            clearContentForm() {
                document.getElementById('content-title').value = '';
                document.getElementById('content-editor').innerHTML = '';
                document.getElementById('content-category').value = '';
                document.getElementById('images-preview').innerHTML = '';
                document.getElementById('video-preview').innerHTML = '';
                this.editingContentId = null;
                document.getElementById('submit-content').innerHTML = '<i class="fas fa-save"></i> Save Content';
                document.getElementById('submit-content').classList.remove('btn-warning');
            },

            async generateQRCode() {
                const treeId = document.getElementById('tree-id').value.trim();
                const treeName = document.getElementById('tree-name').value.trim();
                const plantedDate = document.getElementById('planted-date').value;
                const location = document.getElementById('location').value.trim();
                const plantedBy = document.getElementById('planted-by').value.trim();
                const scientificName = document.getElementById('scientific-name').value.trim();
                const treeHealth = document.getElementById('tree-health').value;
                const treeHeight = document.getElementById('tree-height').value;
                const description = document.getElementById('tree-description').value.trim();

                if (!treeId || !treeName || !plantedDate || !location || !plantedBy) {
                    this.showToast('Please fill all required fields', 'error');
                    return;
                }

                this.showToast('Generating QR code...', 'info');

                const files = [];
                
                document.querySelectorAll('#tree-images-preview .image-preview-item img').forEach(img => {
                    if (img.src.startsWith('data:')) {
                        files.push({
                            name: `tree_image_${Date.now()}.jpg`,
                            type: 'image',
                            data: img.src
                        });
                    }
                });

                const treeVideoPreview = document.querySelector('#tree-video-preview .video-preview-item');
                if (treeVideoPreview) {
                    const videoData = treeVideoPreview.getAttribute('data-video-data');
                    const videoName = treeVideoPreview.getAttribute('data-video-name') || 'tree_video.mp4';
                    
                    if (videoData) {
                        files.push({
                            name: videoName,
                            type: 'video',
                            data: videoData
                        });
                    }
                }

                const qrData = {
                    treeId: treeId,
                    treeName: treeName,
                    scientificName: scientificName,
                    plantedDate: plantedDate,
                    location: location,
                    plantedBy: plantedBy,
                    healthStatus: treeHealth,
                    treeHeight: treeHeight,
                    description: description
                };

                try {
                    const response = await fetch('/api/qr', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${this.sessionToken || ''}`
                        },
                        body: JSON.stringify({
                            data: qrData,
                            files: files
                        })
                    });

                    const result = await response.json();

                    if (result.success) {
                        document.getElementById('qr-code-img').src = result.qrCodeUrl;
                        
                        let qrDataHTML = `
                            <div class="qr-data-row"><strong>Tree ID:</strong> ${treeId}</div>
                            <div class="qr-data-row"><strong>Tree Name:</strong> ${treeName}</div>
                            ${scientificName ? `<div class="qr-data-row"><strong>Scientific:</strong> ${scientificName}</div>` : ''}
                            <div class="qr-data-row"><strong>Planted:</strong> ${this.formatDate(plantedDate)}</div>
                            <div class="qr-data-row"><strong>Location:</strong> ${location}</div>
                            <div class="qr-data-row"><strong>Planted By:</strong> ${plantedBy}</div>
                            ${treeHealth ? `<div class="qr-data-row"><strong>Health:</strong> ${treeHealth}</div>` : ''}
                            ${treeHeight ? `<div class="qr-data-row"><strong>Height:</strong> ${treeHeight} ft</div>` : ''}
                            ${description ? `<div class="qr-data-row"><strong>Description:</strong> ${description.substring(0, 50)}${description.length > 50 ? '...' : ''}</div>` : ''}
                        `;

                        document.getElementById('qr-data-display').innerHTML = qrDataHTML;
                        
                        let mediaHTML = '';
                        if (result.treeImages && result.treeImages.length > 0) {
                            mediaHTML += '<div style="margin-top: 20px;"><strong>Tree Images:</strong><div class="images-grid">';
                            result.treeImages.forEach(img => {
                                mediaHTML += `
                                    <div class="image-preview-item" style="cursor: pointer;" onclick="app.openImageModal('${img.url}')">
                                        <img src="${img.url}">
                                    </div>
                                `;
                            });
                            mediaHTML += '</div></div>';
                        }
                        
                        if (result.treeVideoUrl) {
                            mediaHTML += `
                                <div style="margin-top: 20px;">
                                    <strong>Tree Video:</strong>
                                    <video controls style="max-width: 100%; margin-top: 10px; border-radius: var(--border-radius-lg);">
                                        <source src="${result.treeVideoUrl}" type="video/mp4">
                                    </video>
                                </div>
                            `;
                        }
                        
                        document.getElementById('qr-media-preview').innerHTML = mediaHTML;
                        
                        await this.loadQRFromServer();
                        await this.loadStats();
                        
                        document.getElementById('qr-preview-section').classList.add('visible');
                        this.showToast('QR Code generated successfully!', 'success');
                        
                        setTimeout(() => {
                            document.getElementById('qr-preview-section').scrollIntoView({ behavior: 'smooth' });
                        }, 100);
                    } else {
                        this.showToast('Error: ' + (result.error || 'Unknown error'), 'error');
                    }
                } catch (error) {
                    console.error('QR generation error:', error);
                    this.showToast('Failed to generate QR code', 'error');
                }
            },

            displayQRHistory() {
                const container = document.getElementById('qr-history-container');
                if (!container) return;
                
                if (this.qrData.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-qrcode"></i>
                            <h3>No QR Codes Generated</h3>
                            <p>Generate your first tree QR code using the form above.</p>
                        </div>
                    `;
                    return;
                }

                let html = '<div class="table-responsive"><table class="qr-table"><thead><tr><th>QR</th><th>Tree ID</th><th>Name</th><th>Location</th><th>Planted</th><th>Actions</th></tr></thead><tbody>';
                
                this.qrData.forEach(item => {
                    html += `
                        <tr>
                            <td><img src="${item.qrCodeUrl}" class="qr-small"></td>
                            <td><strong>${item.treeId}</strong></td>
                            <td>${item.treeName}</td>
                            <td>${item.location}</td>
                            <td>${item.displayDate}</td>
                            <td>
                                <button class="admin-btn" style="background: #3b82f6; color: white; padding: 8px;" onclick="app.viewQRDetails('${item.id}')">
                                    <i class="fas fa-eye"></i>
                                </button>
                                ${this.isAdminLoggedIn ? `
                                    <button class="admin-btn delete-btn" style="padding: 8px;" onclick="app.deleteQRItem('${item.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                ` : ''}
                            </td>
                        </tr>
                    `;
                });

                html += '</tbody></table></div>';
                container.innerHTML = html;
            },

            viewQRDetails(qrId) {
                const item = this.qrData.find(q => q.id === qrId);
                if (item) {
                    let qrDataHTML = `
                        <div class="qr-data-row"><strong>Tree ID:</strong> ${item.treeId}</div>
                        <div class="qr-data-row"><strong>Tree Name:</strong> ${item.treeName}</div>
                        <div class="qr-data-row"><strong>Location:</strong> ${item.location}</div>
                        <div class="qr-data-row"><strong>Planted:</strong> ${item.displayDate}</div>
                        ${item.healthStatus ? `<div class="qr-data-row"><strong>Health:</strong> ${item.healthStatus}</div>` : ''}
                        ${item.treeHeight ? `<div class="qr-data-row"><strong>Height:</strong> ${item.treeHeight} ft</div>` : ''}
                        ${item.scientificName ? `<div class="qr-data-row"><strong>Scientific:</strong> ${item.scientificName}</div>` : ''}
                        ${item.plantedBy ? `<div class="qr-data-row"><strong>Planted By:</strong> ${item.plantedBy}</div>` : ''}
                        ${item.description ? `<div class="qr-data-row"><strong>Description:</strong> ${item.description.substring(0, 100)}${item.description.length > 100 ? '...' : ''}</div>` : ''}
                    `;

                    let mediaHTML = '';
                    if (item.media && item.media.length > 0) {
                        mediaHTML += '<div style="margin-top: 20px;"><strong>Tree Images:</strong><div class="images-grid">';
                        item.media.forEach(img => {
                            mediaHTML += `
                                <div class="image-preview-item" style="cursor: pointer;" onclick="app.openImageModal('${img.url}')">
                                    <img src="${img.url}">
                                </div>
                            `;
                        });
                        mediaHTML += '</div></div>';
                    }

                    if (item.videoData) {
                        mediaHTML += `
                            <div style="margin-top: 20px;">
                                <strong>Tree Video:</strong>
                                <video controls style="max-width: 100%; margin-top: 10px; border-radius: var(--border-radius-lg);">
                                    <source src="${item.videoData}" type="video/mp4">
                                </video>
                            </div>
                        `;
                    }

                    document.getElementById('qr-code-img').src = item.qrCodeUrl;
                    document.getElementById('qr-data-display').innerHTML = qrDataHTML;
                    document.getElementById('qr-media-preview').innerHTML = mediaHTML;
                    document.getElementById('qr-preview-section').classList.add('visible');
                    
                    document.getElementById('qr-preview-section').scrollIntoView({ behavior: 'smooth' });
                }
            },

            async deleteQRItem(qrId) {
                if (!this.isAdminLoggedIn) {
                    this.showToast('Admin login required', 'warning');
                    return;
                }

                if (confirm('Delete this QR entry?')) {
                    try {
                        const response = await fetch(`/api/qr/${qrId}`, {
                            method: 'DELETE',
                            headers: {
                                'Authorization': `Bearer ${this.sessionToken || ''}`
                            }
                        });

                        const result = await response.json();

                        if (result.success) {
                            await this.loadQRFromServer();
                            await this.loadStats();
                            this.showToast('QR entry deleted', 'success');
                        } else {
                            this.showToast('Error deleting QR entry', 'error');
                        }
                    } catch (error) {
                        console.error('Delete error:', error);
                        this.showToast('Failed to delete QR entry', 'error');
                    }
                }
            },

            printQR() {
                const qrPreview = document.getElementById('qr-preview-section');
                if (qrPreview.classList.contains('visible')) {
                    const treeId = document.getElementById('tree-id').value || 'Tree';
                    const printWindow = window.open('', '_blank');
                    printWindow.document.write(`
                        <html>
                            <head>
                                <title>Tree QR Code - ${treeId}</title>
                                <style>
                                    body { font-family: Inter, sans-serif; padding: 40px; text-align: center; background: #f8fafc; }
                                    h1 { color: #0a1a2f; font-family: 'Playfair Display', serif; }
                                    img { max-width: 300px; margin: 20px; border: 4px solid #c9a959; border-radius: 16px; }
                                    .data { text-align: left; max-width: 500px; margin: 20px auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
                                    .row { margin: 10px 0; padding: 5px; border-bottom: 1px solid #ddd; }
                                </style>
                            </head>
                            <body>
                                <h1>Tree QR Code - ${treeId}</h1>
                                <img src="${document.getElementById('qr-code-img').src}">
                                <div class="data">${document.getElementById('qr-data-display').innerHTML.replace(/<div class="qr-data-row">/g, '<div class="row">')}</div>
                            </body>
                        </html>
                    `);
                    printWindow.document.close();
                    printWindow.focus();
                    setTimeout(() => {
                        printWindow.print();
                        printWindow.close();
                    }, 250);
                }
            },

            saveQR() {
                const qrImg = document.getElementById('qr-code-img');
                if (qrImg.src) {
                    const link = document.createElement('a');
                    link.href = qrImg.src;
                    link.download = 'tree-qr-' + Date.now() + '.png';
                    link.click();
                    this.showToast('QR code saved', 'success');
                }
            },

            updateStats() {
                document.getElementById('cases-count').textContent = this.content.filter(i => i.type === 'case').length;
                document.getElementById('posts-count').textContent = this.content.filter(i => i.type === 'post').length;
                document.getElementById('blogs-count').textContent = this.content.filter(i => i.type === 'blog').length;
                document.getElementById('announcements-count').textContent = this.content.filter(i => i.type === 'announcement').length;
                document.getElementById('qr-count').textContent = this.qrData.length;
            },

            searchContent(type, query) {
                const container = document.getElementById(type + '-container');
                if (!container) return;
                
                const cards = container.querySelectorAll('.content-card');
                const normalizedQuery = query.toLowerCase().trim();
                
                if (!normalizedQuery) {
                    cards.forEach(card => card.style.display = 'block');
                    return;
                }
                
                cards.forEach(card => {
                    const title = card.querySelector('.card-title')?.textContent.toLowerCase() || '';
                    const text = card.querySelector('.card-text')?.textContent.toLowerCase() || '';
                    const category = card.querySelector('.card-category')?.textContent.toLowerCase() || '';
                    
                    if (title.includes(normalizedQuery) || text.includes(normalizedQuery) || category.includes(normalizedQuery)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            },

            filterCases(filter) {
                const cards = document.querySelectorAll('#cases-container .content-card');
                cards.forEach(card => {
                    const category = card.querySelector('.card-category')?.textContent.toLowerCase() || '';
                    if (filter === 'all' || category.includes(filter)) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            },

            openImageModal(src) {
                const modal = document.getElementById('image-modal');
                const img = document.getElementById('modal-image');
                img.src = src;
                modal.style.display = 'flex';
            },

            openVideoModal(src, contentId) {
                const modal = document.getElementById('video-modal');
                const video = document.getElementById('modal-video');
                
                if (src && src !== '#' && src !== 'video-preview-placeholder') {
                    video.src = src;
                } else {
                    if (contentId) {
                        const item = this.content.find(c => c.id === contentId);
                        if (item && item.media) {
                            const videoMedia = item.media.find(m => m.type === 'video');
                            if (videoMedia && videoMedia.url) {
                                video.src = videoMedia.url;
                            }
                        }
                    }
                }
                
                modal.style.display = 'flex';
                
                video.play().catch(e => {
                    console.log('Autoplay prevented');
                });
            },

            formatDate(date) {
                if (!date) return 'Unknown date';
                return new Date(date).toLocaleDateString('en-IN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            },

            escapeHTML(text) {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            },

            // Logout function
            logout() {
                if (this.isAdminLoggedIn) {
                    fetch('/api/auth/logout', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ token: this.sessionToken })
                    }).finally(() => {
                        this.isAdminLoggedIn = false;
                        this.sessionToken = null;
                        sessionStorage.removeItem('adminToken');
                        sessionStorage.removeItem('adminEmail');
                        document.getElementById('admin-photo-btn').classList.remove('visible');
                        this.showToast('Logged out successfully', 'info');
                    });
                }
            }
        };

        // Add logout button to admin panel (optional)
        // You can add this to your HTML if you want a logout button

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => app.init());
        window.app = app;
    </script>
</body>
</html>